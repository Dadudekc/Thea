[
  {
    "task_id": "enable_code_apply_in_cursor_agent_001",
    "status": "PENDING",
    "task_type": "refactor_agent",
    "action": "Enhance CursorControlAgent._handle_generate_code to use CodeApplicator.",
    "params": {
      "target_agent_file": "agents/cursor_control_agent.py",
      "target_method": "_handle_generate_code",
      "tool_to_use": "tools/code_applicator.py",
      "description": "Modify the _handle_generate_code handler. After successfully sending a prompt via CursorPromptController, it needs a mechanism to retrieve the generated code (Assumption: For now, assume code is manually copied to clipboard or a known temp file). Then, invoke tools/code_applicator.py via CursorTerminalController to apply the retrieved code to the target file. The handler should only return True (leading to task COMPLETED status) if BOTH prompt sending AND code application succeed.",
      "requirements": [
        "Modify handler logic.",
        "Add step to retrieve generated code (placeholder needed for retrieval method).",
        "Call code_applicator.py tool via run_command.",
        "Update success/failure logic based on application result."
      ]
    },
    "target_agent": "CursorControlAgent",
    "priority": 2,
    "timestamp_created": "2024-07-26T12:00:01Z",
    "depends_on": ["infra_build_code_applicator_001"]
  },
  {
    "task_id": "build_feedback_mailbox_writer_001",
    "status": "PENDING",
    "task_type": "refactor_agent",
    "action": "Ensure failed task messages include structured error context in error mailbox.",
    "params": {
      "target_component": "agents/cursor_control_agent.py or _agent_coordination/mailbox_utils.py",
      "description": "When a task fails within an agent's message handler (_process_mailbox_message), ensure the message file moved to the agent's 'error/' directory contains not just the original message, but also structured error information (e.g., timestamp of failure, error message, relevant context/params). This might involve modifying the agent handler to write a new error file or enhancing mailbox_utils.process_directory_loop to capture exceptions and augment the file before moving.",
      "requirements": [
        "Determine best implementation location (agent handler vs. mailbox_utils).",
        "Capture error details effectively.",
        "Write augmented error message file to error directory."
      ]
    },
    "target_agent": "CursorControlAgent",
    "priority": 3,
    "timestamp_created": "2024-07-26T12:00:02Z"
  }
] 